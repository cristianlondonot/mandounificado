import React, {useState, useEffect} from 'react'

const Campo45 = () => {
  const [carenciasPorVeredaBarrio, setCarenciasPorVeredaBarrio] = useState([]);
  const [promedioTotalCarencias, setPromedioTotalCarencias] = useState(0);

  useEffect(() => {
    fetch('https://raw.githubusercontent.com/cristianlondonot/mandounificado-spidersoft/main/data-factor.json')
      .then(response => response.json())
      .then(data => {
        const countByVeredaBarrio = data.reduce((count, item) => {
          const veredaBarrio = item.NOMBRE;

          if (count[veredaBarrio]) {
            count[veredaBarrio]++;
          } else {
            count[veredaBarrio] = 1;
          }

          return count;
        }, {});

        // Convertir el objeto a un array de objetos
        const resultArray = Object.entries(countByVeredaBarrio).map(([veredaBarrio, count]) => ({
          veredaBarrio,
          count,
        }));

        // AsegÃºrate de que setea correctamente el estado como un array
        setCarenciasPorVeredaBarrio(resultArray);

        // Calcular la suma total de carencias
        const totalCount = resultArray.reduce((total, item) => total + item.count, 0);

        // Calcular el promedio total de carencias
        const promedioTotal = totalCount / resultArray.length;

        // Guardar el promedio total en el estado
        setPromedioTotalCarencias(promedioTotal);
      })
      .catch(error => console.error('Error al cargar los datos:', error));
  }, []);
  
  const cambiarColorSegunCarencias = (nombreVeredaBarrio) => {
    const lengthFactor = carenciasPorVeredaBarrio.find(item => item.veredaBarrio === nombreVeredaBarrio)?.count || 0;
  
    let fillColor = '#656565'; // Color predeterminado
    if (lengthFactor <= 3) {
      fillColor = '#387905';
    } else if (lengthFactor <= 6) {
      fillColor = '#feba00';
    } else if (lengthFactor <= 9) {
      fillColor = '#F2860D';
    } else if (lengthFactor <= 12) {
      fillColor = '#fc6107';
    } else if (lengthFactor < 15) {
      fillColor = '#FC0707';
    }
  
    return fillColor;
  };
  return (
    <div className='w-full min-h-96'>
      <svg
        id="uuid-3fc27b35-e976-4877-90f4-726474e6125d"
        xmlns="http://www.w3.org/2000/svg"
        width={257.09}
        height={210.77}
        xmlnsXlink="http://www.w3.org/1999/xlink"
        viewBox="0 0 157.09 110.77"
        className='m-auto'
      >
        <polygon
          fill={cambiarColorSegunCarencias('CAMPO 45')}
          className="uuid-cb266199-e391-47d4-ae29-7adc7cb355fc"
          points="73.87 2.24 76.64 2.49 78.9 2.49 81.42 2.49 83.43 2.74 83.68 2.99 84.69 4.5 84.94 6.53 85.69 8.27 86.2 10.3 87.2 12.07 88.46 13.57 89.72 15.08 90.47 17.09 90.97 19.11 92.23 20.87 93.24 22.15 93.97 24.41 93.74 26.67 93.74 28.43 94.22 30.44 95.98 30.7 97.49 29.44 98.75 27.93 100.76 28.43 102.77 28.68 104.78 29.19 107.05 29.44 109.81 29.19 112.08 28.94 114.34 27.93 116.35 27.43 119.12 27.18 121.38 26.92 123.14 26.42 125.41 25.92 127.42 25.67 129.43 25.67 131.69 25.41 133.7 25.41 135.95 24.91 137.71 25.16 139.72 25.67 141.48 27.18 142.99 28.43 144.5 29.44 145.76 30.7 146.51 32.46 148.02 33.99 149.78 34.24 151.54 33.73 153.8 32.71 155.56 31.95 155.06 33.73 154.56 35.49 154.56 37.51 154.05 39.77 153.8 42.28 153.8 44.05 153.05 46.08 152.8 48.07 151.79 49.83 150.28 51.36 148.77 52.6 147.77 54.13 146.76 56.12 145.76 57.65 143.74 58.4 141.73 57.65 139.72 58.65 138.46 59.91 136.2 60.66 133.96 60.66 132.2 60.66 130.44 61.17 128.68 62.42 127.67 64.18 126.41 65.44 124.4 65.95 122.39 65.19 120.63 64.94 119.12 65.95 118.11 67.45 116.35 67.96 114.84 67.2 113.08 66.45 111.57 67.45 109.56 68.23 109.31 70.24 109.31 72 107.05 72.25 105.29 72 103.28 72 102.02 73.76 101.26 75.77 99.25 76.28 97.24 76.53 95.73 74.77 94.73 73.26 92.73 73.01 90.97 74.01 90.47 75.52 89.97 77.28 89.72 79.29 90.97 80.82 92.23 82.33 92.23 84.09 91.98 85.85 92.48 87.61 90.97 88.62 89.72 88.37 89.21 88.12 88.21 86.36 86.45 85.85 85.94 87.61 85.69 89.37 85.19 91.16 83.43 92.16 81.42 92.39 79.66 93.65 77.9 95.16 76.14 95.91 74.38 96.67 72.87 98.2 71.36 99.71 70.1 100.96 70.1 103.23 68.84 104.74 67.33 105.24 66.33 106.75 66.33 108.76 64.82 109.77 63.06 109.77 62.05 108.01 60.04 107.75 58.78 106.75 57.28 105.24 57.02 103.23 55.52 102.47 53.52 102.47 52.02 101.72 50.25 101.22 49.48 99.43 47.49 99.18 45.73 97.93 44.72 96.67 44.72 96.19 45.2 94.17 44.72 92.16 43.97 90.13 42.71 88.87 41.43 87.36 40.43 85.6 39.67 83.84 39.67 82.08 40.68 80.07 41.68 78.54 41.68 76.78 40.68 75.02 39.19 73.01 37.91 71.75 36.42 69.99 35.67 67.96 35.14 65.69 34.39 63.93 34.16 63.93 32.63 63.93 30.64 64.18 28.1 64.18 27.87 64.18 27.37 63.93 27.12 63.68 26.85 63.43 26.62 62.93 26.62 62.68 26.62 62.42 26.85 61.92 27.12 61.17 28.61 58.65 29.63 57.14 32.13 53.12 32.9 51.59 32.63 51.11 32.63 50.84 32.63 50.35 32.4 50.08 32.13 49.35 31.9 48.32 32.13 47.59 32.4 46.83 32.63 46.31 32.9 45.55 32.9 44.8 32.63 44.05 32.63 43.54 31.9 43.04 31.37 42.54 30.87 42.28 30.37 42.03 30.14 41.78 29.86 41.53 29.63 41.28 28.88 40.27 28.38 40.02 28.1 39.52 27.87 39.27 27.37 38.76 27.12 38.76 26.62 38.51 26.11 38.26 25.34 38.01 24.58 37.76 24.35 37.76 23.85 37.51 23.35 37.26 22.59 36.75 22.09 36.5 21.82 36 21.31 35.75 20.83 35.24 20.56 34.99 20.06 34.49 19.55 34.24 19.32 33.99 18.57 33.73 18.07 33.48 16.28 32.71 15.8 32.2 15.3 31.45 14.8 31.45 13.54 30.7 13.04 30.7 12.53 30.7 12.03 31.2 11.53 31.2 10.77 31.2 10.27 31.2 9.77 31.2 9.01 30.95 8.51 30.44 8.01 30.19 7.75 29.94 7.5 29.44 6.75 28.68 6.25 28.18 5.99 27.93 5.49 27.18 4.99 26.67 4.74 26.17 4.23 25.92 3.73 25.41 2.98 25.16 2.22 24.16 1.97 23.4 1.72 22.4 1.47 21.89 1.22 20.62 1.47 20.62 1.72 20.62 1.72 20.36 1.72 20.11 1.97 20.11 2.22 19.86 2.72 19.61 2.47 19.36 2.98 18.86 3.48 17.85 3.73 17.09 4.23 16.34 4.49 16.34 4.74 15.84 4.99 15.59 4.99 15.33 5.24 15.33 5.24 15.08 4.99 14.83 4.99 14.58 5.99 14.58 7.5 14.08 7.75 14.08 9.51 13.07 11.53 12.32 13.04 11.81 15.05 10.56 16.79 9.8 18.8 8.8 20.33 7.79 22.09 7.29 24.08 7.29 25.84 7.54 28.1 7.29 30.37 6.76 32.4 6.01 34.91 5.53 37.16 4.77 39.44 3.77 41.2 3.77 42.96 3.26 45.48 3.49 47.49 4 49.48 3.49 51.49 3.49 53.52 2.99 55.26 2.99 57.28 2.74 59.54 2.74 61.3 2.49 63.56 2.24 65.32 1 67.08 1 69.1 1.23 71.36 1.23 73.87 2.24"
        />
      </svg>
    </div>
  )
}

export default Campo45